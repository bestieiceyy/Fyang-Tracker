<!DOCTYPE html>
<html>
<head>
  <title>Fyang Live Tracker</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 50px; background: #fafafa; }
    .box { font-size: 32px; padding: 30px; border-radius: 15px; background: #f0f0f0; display: inline-block; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    #fyang, #will { font-size: 36px; margin: 15px 0; }
    #gap { font-size: 40px; margin-top: 20px; font-weight: bold; }
    .gap-green { color: green; }
    .gap-red { color: red; }
  </style>
</head>
<body>
  <div class="box">
    <div id="fyang"></div>
    <div id="will"></div>
    <div id="gap"></div>
  </div>

  <script>
    const POLL_ID = "15909793";
    let prevFyang = null, prevWill = null;

    function updateVotes(data) {
      // parse JSON inside returned JS
      let html = data.responses[0].i;
      let fyangMatch = html.match(/Fyang Smith.*?(\d+)/i);
      let willMatch = html.match(/Will Ashley.*?(\d+)/i);

      if (fyangMatch && willMatch) {
        let fyang = parseInt(fyangMatch[1].replace(/,/g, ''));
        let will = parseInt(willMatch[1].replace(/,/g, ''));

        let fyangAdded = prevFyang !== null ? fyang - prevFyang : 0;
        let willAdded = prevWill !== null ? will - prevWill : 0;

        document.getElementById("fyang").innerText =
          `Fyang Smith: ${fyang.toLocaleString()} (+${fyangAdded.toLocaleString()})`;
        document.getElementById("will").innerText =
          `Will Ashley: ${will.toLocaleString()} (+${willAdded.toLocaleString()})`;

        let diff = fyang - will;
        let diffAdded = (fyangAdded - willAdded);
        let gapElem = document.getElementById("gap");

        if (diff > 0) {
          gapElem.innerText = `Gap: ${diff.toLocaleString()} (+${diffAdded.toLocaleString()}) Fyang leading`;
          gapElem.className = "gap-green";
        } else if (diff < 0) {
          gapElem.innerText = `Gap: ${Math.abs(diff).toLocaleString()} (${diffAdded.toLocaleString()}) Will leading`;
          gapElem.className = "gap-red";
        } else {
          gapElem.innerText = `Gap: 0 (${diffAdded.toLocaleString()}) Tied`;
          gapElem.className = "";
        }

        prevFyang = fyang;
        prevWill = will;
      }
    }

    function fetchVotes() {
      let script = document.createElement("script");
      script.src = `https://polls.polldaddy.com/vote-js.php?p=${POLL_ID}&a=0&b=0&_=${Date.now()}`;
      document.body.appendChild(script);
    }

    // override pollDaddy callback
    window.PDRTJS_Respond = function(data) {
      updateVotes(data);
    };

    fetchVotes();
    setInterval(fetchVotes, 2000); // refresh every 2s
  </script>
</body>
</html>
